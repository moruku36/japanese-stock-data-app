# 🎯 新機能利用ガイド

## 📋 概要

日本の株式データ分析システムが大幅にアップグレードされ、以下の**6つの強力な新機能**が追加されました：

| 機能 | 概要 | 主な用途 | 優先度 |
|-----|-----|---------|--------|
| 🔔 **カスタムアラート** | パーソナライズされた価格・指標アラート | リスク管理・トレーディング | 🔥 **高** |
| 💼 **ポートフォリオ管理** | 投資ポートフォリオ作成・管理・追跡 | 投資戦略・資産管理 | 🔥 **高** |
| 🎯 **強化ダッシュボード** | 総合的な市場監視・分析 | リアルタイム市場分析・トレンド把握 | 🔥 **高** |
| 📈 **ポートフォリオ最適化** | 科学的資産配分 | 投資戦略・リスク管理 | 🟡 **中** |
| 📡 **API監視** | システム健全性監視 | 運用管理・パフォーマンス分析 | 🟡 **中** |

## 🚀 クイックスタート

### Step 1: 環境準備

```bash
# プロジェクトディレクトリに移動
cd japanese-stock-data-app

# 依存関係をインストール（初回のみ）
pip install -r requirements.txt

# 追加で必要なパッケージ
pip install scipy plotly yfinance streamlit pandas numpy requests email-validator schedule pypfopt empyrical ffn folium wordcloud
```

### Step 2: アプリケーション起動

```bash
# Streamlitアプリケーションを起動
python -m streamlit run src/web/web_app.py
```

### Step 3: ブラウザでアクセス

アプリケーション起動後、自動的にブラウザが開くか、以下のURLにアクセス：
- **ローカルURL**: `http://localhost:8501`
- **ネットワークURL**: 起動時に表示されるネットワークIPを使用

### Step 4: 新機能の利用

左側のサイドバーから新機能を選択：

```text
📍 ナビゲーションメニュー
├── 🏠 ホーム
├── 🎯 強化ダッシュボード       ← NEW!
├── 🔔 カスタムアラート         ← NEW!
├── � ポートフォリオ管理        ← NEW!
├── �📈 ポートフォリオ最適化      ← 既存機能
├── 📡 API監視               ← 既存機能
└── ... その他の既存機能
```

## 💡 新機能詳細

### 🔔 カスタムアラート機能

**目的**: パーソナライズされた価格・指標に基づくリアルタイムアラート

**主要コンポーネント**:

- **🎯 価格アラート**
  - 指定価格での買い/売りシグナル
  - 変動率アラート（±X%の変動）
  - 出来高急増アラート

- **📊 テクニカル指標アラート**
  - RSI買われすぎ/売られすぎ
  - MACD シグナルクロス
  - 移動平均線クロス

- **� 通知システム**
  - UI内通知（リアルタイム）
  - メール通知（SMTP設定）
  - サウンド通知（ブラウザbeep音）

- **⚙️ アラート管理**
  - 有効期限設定
  - 最大トリガー数制限
  - カスタムメッセージ

### 💼 ポートフォリオ管理機能

**目的**: 投資ポートフォリオの作成・管理・追跡・分析

**主要コンポーネント**:

- **💱 取引管理**
  - 買付・売却の記録
  - 取引手数料の考慮
  - 資金管理（キャッシュポジション）

- **📊 ポジション追跡**
  - リアルタイム評価損益
  - 平均取得価格の計算
  - ポートフォリオ比重の可視化

- **� パフォーマンス分析**
  - 総資産価値の推移
  - 銘柄別・セクター別損益
  - ベスト・ワーストパフォーマー

- **⚠️ リスク分析**
  - 集中度リスクの監視
  - セクター分散度チェック
  - ポートフォリオバランス評価

### 📈 ポートフォリオ最適化機能

**目的**: 現代ポートフォリオ理論に基づく科学的投資戦略

**最適化手法**:

- **🎯 効率的フロンティア**
  ```
  リスク vs リターンの最適解を可視化
  └── 複数の最適化目標
      ├── 最大シャープレシオ
      ├── 最小分散
      └── 目標リターン達成
  ```

- **🎲 モンテカルロシミュレーション**
  - 10,000回以上のシナリオ分析
  - 確率分布による予測精度向上
  - 極端事象への対応策提示

- **⚠️ リスク指標計算**
  - **VaR** (Value at Risk): 最大予想損失
  - **CVaR** (Conditional VaR): 条件付きリスク
  - **シャープレシオ**: リスク調整後リターン

- **⚖️ 資産配分最適化**
  - 制約条件付き最適化
  - セクター・地域分散考慮
  - 取引コスト込み計算

### 📡 API監視機能

**目的**: システムの安定性とパフォーマンスの24/7監視

**監視項目**:

- **🔍 ヘルスチェック**
  ```
  監視対象API
  ├── Yahoo Finance API
  ├── Stooq データソース
  ├── 内部データベース
  └── ネットワーク接続
  ```

- **⏱️ パフォーマンス測定**
  - レスポンス時間の継続監視
  - スループット分析
  - エラー率の追跡

- **🚨 インテリジェントアラート**
  - 閾値ベースの自動アラート
  - 異常検知アルゴリズム
  - 段階的エスカレーション

- **📊 統計ダッシュボード**
  - リアルタイム状態表示
  - 履歴データの可視化
  - SLA達成率レポート

## 🔧 システム要件

### 必須依存関係

| パッケージ | バージョン | 用途 |
|-----------|-----------|------|
| `streamlit` | 最新 | Webフレームワーク |
| `plotly` | 最新 | インタラクティブ可視化 |
| `scipy` | 最新 | 数値最適化・統計計算 |
| `numpy` | 最新 | 数値計算基盤 |
| `pandas` | 最新 | データ処理・分析 |
| `yfinance` | 最新 | 株価データ取得 |
| `requests` | 最新 | HTTP通信 |

### インストールコマンド

```bash
# 一括インストール
pip install scipy plotly yfinance streamlit pandas numpy requests

# または要件ファイルから（推奨）
pip install -r requirements.txt
```

## 🛠️ トラブルシューティング

### よくある問題と解決策

#### 1. 新機能のインポートエラー

**症状**: 「新機能のインポートに失敗しました」の表示

**解決策**:
```bash
# 依存関係を再インストール
pip install --upgrade scipy plotly yfinance

# テストスクリプトで確認
python tests/test_new_features.py
```

#### 2. ダッシュボードが表示されない

**原因**: データソースへの接続問題

**解決策**:
- インターネット接続を確認
- API制限を確認（Yahoo Finance等）
- プロキシ設定を確認

#### 3. ポートフォリオ最適化が失敗する

**原因**: 入力データの不整合

**解決策**:
- 有効な銘柄コードを入力
- 十分な期間のデータが存在することを確認
- 銘柄数を3つ以上に設定

#### 4. API監視でエラーが発生

**原因**: ネットワークまたは権限の問題

**解決策**:
- ファイアウォール設定を確認
- アンチウイルスソフトの除外設定
- 管理者権限での実行を試行

### 診断コマンド

```bash
# 環境診断
python tests/test_new_features.py

# 詳細ログの確認
python -c "import logging; logging.basicConfig(level=logging.DEBUG)"
python -m streamlit run src/web/web_app.py
```

## 📚 追加リソース

### ドキュメント

- **[NEW_FEATURES_SUMMARY.md](NEW_FEATURES_SUMMARY.md)**: 技術的な実装詳細
- **[system_architecture.md](system_architecture.md)**: システム全体のアーキテクチャ
- **README.md**: プロジェクト全体の概要

### サンプルワークフロー

#### 1. 日次市場分析フロー

```mermaid
graph LR
    A[アプリ起動] --> B[ダッシュボード確認]
    B --> C[市場概要チェック]
    C --> D[セクター動向分析]
    D --> E[注目銘柄選定]
```

#### 2. ポートフォリオ構築フロー

```mermaid
graph LR
    A[銘柄選定] --> B[最適化実行]
    B --> C[効率的フロンティア確認]
    C --> D[リスク評価]
    D --> E[配分決定]
```

## 🔐 セキュリティ・プライバシー

### データ保護

- **ローカル処理**: すべての計算はローカル環境で実行
- **データ暗号化**: 機密データの暗号化保存
- **アクセス制御**: 段階的な権限管理

### 外部API利用

- **最小限のデータ取得**: 必要最小限のデータのみ取得
- **レート制限遵守**: API提供者の制限を厳格に遵守
- **エラーハンドリング**: 適切なフォールバック機能

## 📞 サポート・コミュニティ

### 問題報告

問題が発生した場合の連絡先：

1. **GitHub Issues**: バグ報告・機能要望
2. **ログファイル**: `logs/stock_system.log` を確認
3. **診断情報**: `python tests/test_new_features.py` の結果を添付

### 貢献方法

プロジェクトへの貢献を歓迎します：

- **バグ修正**: Issue報告・Pull Request
- **機能追加**: 新機能の提案・実装
- **ドキュメント改善**: 説明の追加・翻訳

---

## 🎉 まとめ

新機能により、日本の株式データ分析システムは次のレベルに到達しました：

✅ **プロフェッショナルグレード**: 機関投資家レベルの分析機能  
✅ **リアルタイム監視**: 24/7の市場監視体制  
✅ **科学的手法**: 現代ポートフォリオ理論の実装  
✅ **高い信頼性**: 包括的な監視・アラート機能  

これらの新機能を活用して、より効果的な投資戦略を構築してください！
