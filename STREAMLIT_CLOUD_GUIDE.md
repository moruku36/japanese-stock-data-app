# 🚀 Streamlit Cloud デプロイメントガイド

## 📋 概要

このアプリケーションはセキュア軽量版として最適化されており、Streamlit Cloudで安全に動作します。

## 🎯 エントリーポイントファイル

Streamlit Cloudのエントリーポイントには、次を指定してください：

- **`streamlit_app.py`**（推奨・単一）
  - セキュア軽量版のメインファイル
  - 認証・認可システム搭載
  - Streamlit Cloud最適化済み

## ⚙️ Streamlit Cloud 設定

### デプロイメント設定
```
Repository: moruku36/japanese-stock-data-app
Branch: main
Main file path: streamlit_app.py
```

### 環境変数（オプション）
- 特に設定不要（軽量版のため）

## 🔐 セキュリティ機能

### 認証システム
- **管理者**: `admin` / `admin123`
- **ユーザー**: `user` / `user123`  
- **ゲスト**: ボタンクリックで匿名アクセス

### セキュリティ機能
- ✅ PBKDF2-SHA256 パスワードハッシュ化
- ✅ 役割ベースアクセス制御（RBAC）
- ✅ 入力検証・サニタイゼーション
- ✅ レート制限（60リクエスト/分）
- ✅ セキュアエラーハンドリング

## 📊 機能

### 基本機能
- 株価チャート表示（ローソク足）
- 基本統計情報
- 人気銘柄の選択
- 期間指定（1ヶ月〜2年）

### 権限別機能
- **ゲスト**: 株価チャート表示のみ
- **ユーザー**: チャート + 出来高分析
- **管理者**: 全機能 + 会社情報 + デバッグ情報

## 🛠️ トラブルシューティング

### よくある問題

#### 1. リアルタイム監視エラー
**現象**: `UnboundLocalError: datetime is not defined`

**原因**: 古い`src/web/web_app.py`が実行されている

**解決**: 
- Streamlit Cloudで`streamlit_app.py`を指定
- または`app.py`を使用

#### 2. モジュールインポートエラー
**現象**: `ImportError: No module named 'xxx'`

**解決**: 
- `requirements.txt`の依存関係を確認
- 軽量版は最小限の依存関係のみ

#### 3. 認証画面が表示されない
**現象**: アプリが正常に起動しない

**解決**: 
- ブラウザのキャッシュをクリア
- Streamlit Cloudのアプリを再起動

## 📈 パフォーマンス

### 最適化内容
- ✅ 軽量パッケージのみ使用
- ✅ セキュリティオーバーヘッド最小化
- ✅ レート制限によるリソース保護
- ✅ エラーハンドリング最適化

### リソース使用量
- **メモリ**: ~100MB
- **CPU**: 低負荷
- **ネットワーク**: yfinance APIのみ

## 🎯 次のステップ

1. Streamlit Cloudでのデプロイ確認
2. 認証機能のテスト
3. セキュリティ機能の検証
4. パフォーマンスの確認

## 📞 サポート

問題が発生した場合：
1. エラーメッセージを確認
2. 管理者権限でデバッグ情報を確認
3. Streamlit Cloudのログを確認
